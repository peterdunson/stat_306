---
title: "homework_6"
author: "Peter"
date: "`r Sys.Date()`"
output: html_document
---




Sec 6.8 Exercises # 3,5 (use p=0.3),7,8,9,10,12,14,18 (I will discuss how to obtain credit) \

### Problem 3 \

a.


$n = 4$ rolls. 

$p_1 = \frac{1}{6}$, prob of rolling a 1. \
$p_2 = \frac{1}{6}$, prob of rolling a 2.  \
$P_{\text{else}} = \frac{4}{6}$

Using the general multinomial pmf formula we get: \

$$P(O=o, T=t) = \frac{4!}{o! \cdot t! \cdot (4-0-t)!} \cdot \frac{1}{6}^o \cdot \frac{1}{6}^t \cdot \frac{4}{6}^{4-o-t}$$ with $o \geq 0, t \geq 0, o + t \leq 0$


b.

$P(O = T)$?

We could either have $o=t=0, o=t=1, o=t=2$ since $o + t \leq 0$. \

So, we can use the formula above to solve for each case. \

$o=t=0$:

$P(0,0) = \frac{4!}{4!} \cdot \frac{1}{6}^0 \cdot \frac{1}{6}^0 \cdot \frac{4}{6}^{4} = \frac{256}{1296}$ 

$o=t=1$:

$P(1,1) = \frac{4!}{1!1!2!} \cdot \frac{1}{6}^1 \cdot \frac{1}{6}^1 \cdot \frac{4}{6}^{2} = \frac{192}{1296}$ 

$o=t=2$:

$P(2,2) = \frac{4!}{2!2!} \cdot \frac{1}{6}^2 \cdot \frac{1}{6}^2 \cdot \frac{4}{6}^{0} = \frac{6}{1296}$ 

$P(O=T) = \frac{454}{1296} = 0.3503086$


c.

$P(T=t | O = 1)$?

Using the binomial distribution pmf: \

$$P(O=1) = \binom{4}{1} \cdot \frac{1}{6}^1 \cdot \frac{5}{6}^3 = \frac{500}{1296}$$

Next we use the formula from part a: \

$$P(O=1, T=t) = \frac{4!}{1!t!(3-t)!} \cdot \frac{1}{6}^1 \cdot \frac{1}{6}^t \cdot \frac{4}{6}^{3-t}$$

So, we get: \

$$P(T=t | O = 1) = \frac{P(O=1, T=t)}{P(O=1)} = \frac{\frac{4!}{1!t!(3-t)!} \cdot \frac{1}{6}^1 \cdot \frac{1}{6}^t \cdot \frac{4}{6}^{3-t}}{\binom{4}{1} \cdot \frac{1}{6}^1 \cdot \frac{5}{6}^3}$$
This simplifies to: \

$$P(T=t | O = 1) = \binom{3}{t} \cdot \frac{1}{5}^t \cdot \frac{4}{5}^{3-t}$$ for $t \in {0, 1, 2, 3}$. 

This makes a lot of sense, we know O=1, so in the 3 remaining rolls we only care about prob of a 2, which is 1/5 chance among non 1s and others have 4/5 chance. \


d.

$P(T>0 | O = 1)$?

$P(T>0 | O = 1) = 1 - P(T = 0 | O = 1) = 1 - \binom{3}{0} \cdot \frac{1}{5}^0 \cdot \frac{4}{5}^{3} = 1 - \frac{64}{125} = \frac{61}{125} = 0.488$


### Problem 5
 
N = # of opportunities \

X = # of hits \

$X \sim Bin(p=0.3, N)$

a.

$P(N=n, X=x)$?

$P(N=n) = \frac{1}{3}$

$P(X=x | N=n) = \binom{n}{x} \cdot 0.3^x \cdot 0.7^{n-x}$.

$$P(N=n, X=x) = P(N=n) \cdot P(X=x | N=n) = \frac{1}{3} \cdot \binom{n}{x} \cdot 0.3^x \cdot 0.7^{n-x}$$.

b.

$P_X(x)$?

$$P_X(x) = \sum_{n=max(4,x)}^{6} (\frac{1}{3} \cdot \binom{n}{x} \cdot 0.3^x \cdot 0.7^{n-x})$$
$$
P_X(x) = \begin{cases} 
\frac{1}{3} \left[ \binom{4}{0}0.3^0 0.7^4 + \binom{5}{0}0.3^0 0.7^5 + \binom{6}{0}0.3^0 0.7^6 \right] = 0.17527 & \text{for } x = 0 \\
\frac{1}{3} \left[ \binom{4}{1}0.3^1 0.7^3 + \binom{5}{1}0.3^1 0.7^4 + \binom{6}{1}0.3^1 0.7^5 \right] = 0.35809 & \text{for } x = 1 \\
\frac{1}{3} \left[ \binom{4}{2}0.3^2 0.7^2 + \binom{5}{2}0.3^2 0.7^3 + \binom{6}{2}0.3^2 0.7^4 \right] = 0.29914 & \text{for } x = 2 \\
\frac{1}{3} \left[ \binom{4}{3}0.3^3 0.7^1 + \binom{5}{3}0.3^3 0.7^2 + \binom{6}{3}0.3^3 0.7^3 \right] = 0.13104 & \text{for } x = 3 \\
\frac{1}{3} \left[ \binom{4}{4}0.3^4 0.7^0 + \binom{5}{4}0.3^4 0.7^1 + \binom{6}{4}0.3^4 0.7^2 \right] = 0.03199 & \text{for } x = 4 \\
\frac{1}{3} \left[ \binom{5}{5}0.3^5 0.7^0 + \binom{6}{5}0.3^5 0.7^1 \right] = 0.00421 & \text{for } x = 5 \\
\frac{1}{3} \left[ \binom{6}{6}0.3^6 0.7^0 \right] = 0.00024 & \text{for } x = 6 \\
0 & \text{else}
\end{cases}
$$

c.

$P(N=n | X=2) = \frac{P(N=n, X=2)}{P(X=2)}$

Using $P(X=2)$ from above: \ 

$$
P(N=n \mid X=2) = \begin{cases} 
\frac{\frac{1}{3} \binom{4}{2} (0.3)^2 (0.7)^2}{0.29914} = 0.2948 & \text{if } n = 4 \\
\frac{\frac{1}{3} \binom{5}{2} (0.3)^2 (0.7)^3}{0.29914} = 0.3440 & \text{if } n = 5 \\
\frac{\frac{1}{3} \binom{6}{2} (0.3)^2 (0.7)^4}{0.29914} = 0.3612 & \text{if } n = 6 \\
0 & \text{else}
\end{cases}
$$

d.

$P(N=5 \mid X=3)$?

Using P(X=3) from above: \ 

$$P(N=5 \mid X=3) = \frac{P(N=5, X=3)}{P(X=3)} = \frac{\frac{1}{3} \binom{5}{3} (0.3)^3 (0.7)^2}{0.13104} = \frac{0.0441}{0.13104} = 0.3365$$


### Problem 7

$f(x,y) = ky, 0 < x < 2, 0 < y < 2$

a.

$1 = \int_{0}^{2} \int_{0}^{2} ky \, dx \, dy = \int_{0}^{2} 2ky \, dy = 4k$.

$k = \frac{1}{4}$.


b.

$f_X(x) = \int_{0}^{2} \frac{y}{4} \, dy = \frac{1}{2}, \quad 0 < x < 2$


c.

$$P(Y > X) = \int_{0}^{2} \int_{x}^{2} \frac{y}{4} \, dy \, dx = \int_{0}^{2} \frac{1}{2} - \frac{x^2}{8} \, dx = 1 - \frac{8}{24} = \frac{2}{3}$$


d.

$$f_{Y \mid X}(y \mid x) = \frac{f(x,y)}{f_X(x)} = \frac{\frac{4}{y}}{\frac{1}{2}} = \frac{y}{2}, \quad 0<y<2$$.


### Problem 8

$f(x,y) = x+y, \quad 0<x<1, \quad 0<y<1$

a.

$$\int_{0}^{1} \int_{0}^{1} (x+y) \, dx \, dy = \int_{0}^{1} (\frac{1}{2} + y) \, dy = \left[ \frac{1}{2}y + \frac{1}{2}y^2 \right]_{0}^{1} = 1$$


b.

$$P(X>0.5, Y<0.5) = \int_{0}^{0.5} \int_{0.5}^{1} (x+y) \, dx \, dy = \int_{0}^{0.5} \left[ \frac{1}{2}x^2 + xy \right]_{0.5}^{1} dy = \int_{0}^{0.5} (0.375 + 0.5y) \, dy = \left[ 0.375y + 0.25y^2 \right]_{0}^{0.5} = 0.25$$

c.

$f_X(x) = \int_{0}^{1} (x+y) \, dy = \left[ xy + \frac{1}{2}y^2 \right]_{0}^{1} = x + \frac{1}{2}, \quad 0 < x < 1$


d.

CHECK: $f(x,y) = f_X(x) \cdot f_Y(y)$


We have: \
$f_X(x) = x + \frac{1}{2}$

And by symmetry: \ 

$f_Y(y) = y + \frac{1}{2}$

$f_X(x) \cdot f_Y(y) = (y + \frac{1}{2})(x + \frac{1}{2}) = xy + \frac{x}{2} + \frac{y}{2} + \frac{1}{4} \neq x+y$.

So, X and Y are not independent. \


### Problem 9

a.

$X \sim Unif(0,2), \quad 0<x<2$, $Y \mid X = x \sim Unif(0, x), \quad 0<y<x$

$f_{Y \mid X}(y \mid x) = \frac{1}{x}$

$f_X(x) = \frac{1}{2}$

$f(x,y) = f_{Y \mid X}(y \mid x) \cdot f_X(x) = \frac{1}{2x}, \quad 0<y<x<2$.

b.

No, X and Y are not independent because the range of Y is determined by the value of X. \ 


c.

$P(Y>0.5)$?


$$P(Y>0.5) = \int_{0.5}^{2} \int_{0.5}^{x} \frac{1}{2x} \, dy \, dx = \int_{0.5}^{2} \left( \frac{1}{2} - \frac{1}{4x} \right) dx = \left[ \frac{1}{2}x - \frac{1}{4}\ln(x) \right]_{0.5}^{2} = 0.75 - \frac{1}{2}\ln(2) = 0.4034264$$.

```{r}
0.75 - 0.5*log(2)
```


d.

$P(X+Y>2)$?

$$P(X+Y>2) = \int_{1}^{2} \int_{2-x}^{x} \frac{1}{2x} \, dy \, dx = \int_{1}^{2} \left( \frac{x}{2x} - \frac{2-x}{2x} \right) dx = \int_{1}^{2} \left( 1 - \frac{1}{x} \right) dx = \left[ x - \ln(x) \right]_{1}^{2} = 1 - \ln(2) = 0.3068528$$

```{r}
1 - log(2)
```




### Problem 10

a. 

We could solve this using a double integral, or, knowing that the unit circle has an area of $\pi$, and we know $C * Area = 1$, so $C\pi=1$ and $C= \frac{1}{\pi}$.

b. 

$f_Y(y) = \int_{-\sqrt{1-y^2}}^{\sqrt{1-y^2}} \frac{1}{\pi} \, dx = \frac{1}{\pi} \left[ x \right]_{-\sqrt{1-y^2}}^{\sqrt{1-y^2}}= \frac{2\sqrt{1-y^2}}{\pi}, \quad -1 < y < 1$.


c.

$P(Y>0.5) = \int_{0.5}^{1} \frac{2\sqrt{1-y^2}}{\pi} \, dy = 0.1955012$

```{r}
f_y <- function(y) {
  (2 * sqrt(1 - y^2)) / pi
}

integrate(f_y, lower = 0.5, upper = 1)

```


d.

$f_{X \mid Y}(x \mid y=0.5)$

$f_Y(0.5) = \frac{2\sqrt{1-0.5^2}}{\pi} = \frac{\sqrt{3}}{\pi}$

$x^2 + 0.25 \leq 1 \Rightarrow x^2 \leq 0.75 \Rightarrow -0.75 \leq x \leq 0.75$

$$f_{X \mid Y}(x \mid y=0.5) = \frac{\frac{1}{\pi}}{\frac{\sqrt{3}}{\pi}} = \frac{1}{\sqrt{3}}, \quad -0.75 \leq x \leq 0.75$$


### Problem 12

$f(x \mid \lambda) = \frac{e^{-\lambda}\lambda^x}{x!}, \quad x = 0, 1, 2, \dots$

$P(\lambda = l) = \frac{1}{4}, \quad l \in {0.5, 1, 1.5, 2}$

a.

$f(x, \lambda) = P(X=x, \lambda = l) = P(X=x \mid \lambda = l) \cdot P(\lambda = l) = \frac{e^{-\lambda}\lambda^x}{x!} \cdot \frac{1}{4}$

$f(x, \lambda) = \frac{e^{-\lambda}\lambda^x}{4x!}, \quad x = 0, 1, 2, \dots \quad l \in {0.5, 1, 1.5, 2}$


b.

$P(X=0)$?

$P(X=0) = \sum_{l \in \{0.5, 1, 1.5, 2\}} f(0, \lambda) = \frac{1}{4} \left( e^{-0.5} + e^{-1.0} + e^{-1.5} + e^{-2.0} \right) = 0.3332189$


```{r}
.25 * (exp(-0.5) + exp(-1) + exp(-1.5) + exp(-2))
```


c.

$P(\lambda = l \mid X=0) = \frac{P(X=0, \lambda = l)}{P(X=0)} = \frac{\frac{1}{4}e^{-\lambda}}{0.3332189}$

```{r}
( (1/4) * exp(-0.5) ) / 0.3332189
( (1/4) * exp(-1.0) ) / 0.3332189
( (1/4) * exp(-1.5) ) / 0.3332189
( (1/4) * exp(-2.0) ) / 0.3332189
```


$P(\lambda = 0.5 \mid X=0) = 0.4550542$

$P(\lambda = 1.0 \mid X=0) = 0.2760043$

$P(\lambda = 1.5 \mid X=0) = 0.1674051$

$P(\lambda = 2.0 \mid X=0) = 0.1015363$


### Problem 14

a.

$f(y, p) = f(p) \cdot p(y \mid p) = 6p(1-p) \cdot \binom{2}{y}p^y(1-p)^{2-y}$


b.

$P(Y=2)$?

$f(2,p) = 6p(1-p) \cdot \binom{2}{2}p^2(1-p)^{2-2} = 6p^3(1-p)$

$P(Y=2) = \int_{0}^{1} 6p^3(1-p) \, dp = 0.3$

```{r}
f <- function(p) {
  6 * p^3 * (1 - p)
}

integrate(f, lower = 0, upper = 1)
```


c.

$P(p \mid Y=2) = \frac{f(2,p)}{P(Y=2)} = \frac{6p^3(1-p)}{0.3} = 20p^3(1-p)$

$P(p>0.5 \mid Y=2) = \int_{0.5}^{1} 20(p^3-p^4) \, dp = 0.8125$

```{r}
f_posterior <- function(p) {
  20 * p^3 * (1 - p)
}

integrate(f_posterior, lower = 0.5, upper = 1)
```


### Problem 18

Y = # of makes

$Y \sim \text{Binom}(n, p=0.7)$


a.

$P(Y=4 \mid N=6) = \binom{6}{4}(0.7)^4(0.3)^2 = 0.324135$

$P(N=6, Y=4) = 0.2 \cdot 0.324135 = 0.064827$


b.

$P(N=n, Y=y) = P(N=n) \cdot P(Y=y \mid N=n) = P(N=n) \cdot \binom{n}{y}(0.7)^y(0.3)^{n-y}$

```{r}
n_vals <- c(5, 6, 7, 8, 9, 10)
p_n <- c(0.2, 0.2, 0.2, 0.2, 0.1, 0.1)
p_success <- 0.7

grid <- expand.grid(n = n_vals, y = 0:10)
grid <- grid[grid$y <= grid$n, ]

grid$pn <- p_n[match(grid$n, n_vals)]

grid$joint <- grid$pn * dbinom(grid$y, size = grid$n, prob = p_success)

grid[which.max(grid$joint), ]
```


c.

$P(N=n \mid Y=4) = \frac{P(N=n, Y=4)}{P(Y=4)}$

$P(Y=4) = \sum_{n=5}^{10} P(N=n, Y=4)$

```{r}
n <- 5:10
pn <- c(0.2, 0.2, 0.2, 0.2, 0.1, 0.1)

joint_y4 <- pn * dbinom(4, size = n, prob = 0.7)

cond_dist <- joint_y4 / sum(joint_y4)

data.frame(N = n, Conditional_Prob = cond_dist)
```

$$
P(N=n \mid Y=4)
= \begin{cases} 
0.3267 & n=5 \newline
0.2940 & n=6 \newline
0.2058 & n=7 \newline
0.1235 & n=8 \newline
0.0333 & n=9 \newline
0.0167 & n=10 
\end{cases}
$$



d.

$E(N \mid Y=4) = \sum_{n=5}^{10} n \cdot P(N=n \mid Y=4)$

```{r}
sum(n * cond_dist)
```

$E(N \mid Y=4) = (5 \times 0.3267) + (6 \times 0.2940) + (7 \times 0.2058) + (8 \times 0.1235) + (9 \times 0.0333) + (10 \times 0.0167) = 6.292804$







